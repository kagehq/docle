<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Docle Embed Demo</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      max-width: 1200px;
      margin: 40px auto;
      padding: 0 20px;
      background: #0a0e12;
      color: #e6eef8;
    }
    h1 {
      margin-bottom: 10px;
    }
    .subtitle {
      color: #9aa8b4;
      margin-bottom: 40px;
    }
    .demo-section {
      margin-bottom: 60px;
    }
    h2 {
      color: #8aa2ff;
      margin-bottom: 20px;
    }
    .embed-container {
      border: 2px solid #1b232b;
      border-radius: 12px;
      overflow: hidden;
      background: #11161b;
      margin-bottom: 20px;
    }
    iframe {
      width: 100%;
      height: 400px;
      border: none;
      display: block;
    }
    pre {
      background: #11161b;
      border: 1px solid #1b232b;
      border-radius: 8px;
      padding: 16px;
      overflow-x: auto;
      font-size: 13px;
    }
    code {
      color: #8aa2ff;
    }
    .result {
      background: #11161b;
      border: 1px solid #1b232b;
      border-radius: 8px;
      padding: 16px;
      margin-top: 20px;
    }
    .result h3 {
      margin-top: 0;
      color: #51cf66;
    }
    button {
      background: #8aa2ff;
      color: #051030;
      border: none;
      border-radius: 6px;
      padding: 10px 20px;
      font-weight: 600;
      cursor: pointer;
      margin-right: 10px;
    }
    button:hover {
      opacity: 0.9;
    }
  </style>
</head>
<body>
  <h1>üöÄ Docle Embed Demo</h1>
  <p class="subtitle">Embeddable code playgrounds powered by Cloudflare</p>

  <!-- Example 1: Basic Python Embed -->
  <div class="demo-section">
    <h2>1. Basic Python Embed</h2>
    <div class="embed-container">
      <iframe 
        src="http://localhost:8787/embed?lang=python&code=print(%22Hello%20from%20Docle!%22)"
        id="embed1"
      ></iframe>
    </div>
    <pre><code>&lt;iframe 
  src="https://docle.workers.dev/embed?lang=python&code=print(%22Hello!%22)"
  width="100%" 
  height="400"
&gt;&lt;/iframe&gt;</code></pre>
  </div>

  <!-- Example 2: JavaScript/Node -->
  <div class="demo-section">
    <h2>2. JavaScript/Node Embed</h2>
    <div class="embed-container">
      <iframe 
        src="http://localhost:8787/embed?lang=node&code=console.log(%22Node.js%20is%20running!%22)%3B%0Aconsole.log(Math.PI)%3B"
        id="embed2"
      ></iframe>
    </div>
    <pre><code>&lt;iframe 
  src="https://docle.workers.dev/embed?lang=node&code=console.log('Hi!')"
  width="100%" 
  height="400"
&gt;&lt;/iframe&gt;</code></pre>
  </div>

  <!-- Example 3: Light Theme -->
  <div class="demo-section">
    <h2>3. Light Theme</h2>
    <div class="embed-container" style="background: white;">
      <iframe 
        src="http://localhost:8787/embed?lang=python&theme=light&code=for%20i%20in%20range(5)%3A%0A%20%20%20%20print(f%22Count%3A%20%7Bi%7D%22)"
        id="embed3"
      ></iframe>
    </div>
    <pre><code>&lt;iframe 
  src="https://docle.workers.dev/embed?lang=python&theme=light"
  width="100%" 
  height="400"
&gt;&lt;/iframe&gt;</code></pre>
  </div>

  <!-- Example 4: Read-only -->
  <div class="demo-section">
    <h2>4. Read-only (Demo Mode)</h2>
    <div class="embed-container">
      <iframe 
        src="http://localhost:8787/embed?lang=python&readonly=true&code=def%20fibonacci(n)%3A%0A%20%20%20%20if%20n%20%3C%3D%201%3A%0A%20%20%20%20%20%20%20%20return%20n%0A%20%20%20%20return%20fibonacci(n-1)%20%2B%20fibonacci(n-2)%0A%0Aprint(fibonacci(10))"
        id="embed4"
      ></iframe>
    </div>
    <pre><code>&lt;iframe 
  src="https://docle.workers.dev/embed?lang=python&readonly=true&code=..."
  width="100%" 
  height="400"
&gt;&lt;/iframe&gt;</code></pre>
  </div>

  <!-- Example 5: PostMessage Communication -->
  <div class="demo-section">
    <h2>5. PostMessage API (Interactive Control)</h2>
    <div class="embed-container">
      <iframe 
        src="http://localhost:8787/embed?lang=python&code=x%20%3D%2042%0Aprint(f%22The%20answer%20is%20%7Bx%7D%22)"
        id="embed5"
      ></iframe>
    </div>
    <button onclick="runEmbed5()">‚ñ∂ Run from Parent</button>
    <button onclick="updateEmbed5()">‚úèÔ∏è Update Code</button>
    <div id="result5" class="result" style="display: none;">
      <h3>Result from iframe:</h3>
      <pre id="result5-text"></pre>
    </div>
    <pre><code>// Listen to results
window.addEventListener('message', (e) => {
  if (e.data.type === 'docle-result') {
    console.log('Result:', e.data.data);
  }
});

// Trigger run
iframe.contentWindow.postMessage({ type: 'docle-run' }, '*');

// Update code
iframe.contentWindow.postMessage({ 
  type: 'docle-set-code', 
  code: 'print("New code!")' 
}, '*');</code></pre>
  </div>

  <script>
    // Listen for messages from all embeds
    window.addEventListener('message', (e) => {
      console.log('Message from embed:', e.data);
      
      if (e.data.type === 'docle-ready') {
        console.log('Embed ready:', e.data.data);
      }
      
      if (e.data.type === 'docle-result') {
        console.log('Execution result:', e.data.data);
        
        // Show result for embed5
        const result5 = document.getElementById('result5');
        const result5Text = document.getElementById('result5-text');
        if (result5 && result5Text) {
          result5.style.display = 'block';
          result5Text.textContent = JSON.stringify(e.data.data, null, 2);
        }
      }
    });

    function runEmbed5() {
      const iframe = document.getElementById('embed5');
      iframe.contentWindow.postMessage({ type: 'docle-run' }, '*');
    }

    function updateEmbed5() {
      const iframe = document.getElementById('embed5');
      iframe.contentWindow.postMessage({ 
        type: 'docle-set-code', 
        code: 'import random\nprint(f"Random: {random.randint(1, 100)}")'
      }, '*');
    }
  </script>

  <footer style="margin-top: 60px; padding-top: 40px; border-top: 1px solid #1b232b; color: #9aa8b4; text-align: center;">
    <p>Built with ‚ù§Ô∏è using <a href="https://developers.cloudflare.com/sandbox/" style="color: #8aa2ff;">Cloudflare Sandbox</a></p>
  </footer>
</body>
</html>

